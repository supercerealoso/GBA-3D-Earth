// apuntador a la linea de la pantalla que se esta dibujando
#define CONTADOR_PANTALLA *((volatile unsigned int *)0x04000006)

// apuntador al control de la pantalla
#define CONTROL_PANTALLA *((volatile unsigned int *)0x04000000)

// apuntador al arreglo que contiene todos los pixeles de la pantalla
#define MEMORIA_VIDEO ((volatile unsigned short *)0x06000000)

// numero que representa el encendido de la pantalla
#define ENCENDIDO 0x0403

// el ancho de la pantalla
#define ANCHO_PANTALLA 240

// la mitad del ancho de la pantalla
#define MITAD_ANCHO_PANTALLA 120

// el alto de la pantalla
#define ALTO_PANTALLA 160

// la mitad del alto de la pantalla
#define MITAD_ALTO_PANTALLA 80

// total de pixeles en la pantalla
#define TOTAL_PIXELES 38400

// numero que indica el color rojo
#define ROJO 0x001F

// numero que indica el color azul
#define AZUL 0x7C00

// numero que indica el color verde
#define VERDE 0x03E0

// numero que indica el color blanco
#define BLANCO 0xFFFF

// numero que indica el color negro
#define NEGRO 0x0000

// numero que indica el color gris
#define GRIS 0x3DEF

// valor booleano verdadero
#define VERDADERO 1

// numero de puntos 3D
#define NUMERO_PUNTOS 2048

// arreglo con valores del seno por angulo
const float valores_seno[] = {0.0, 0.0174524064372835, 0.034899496702501, 0.0523359562429438, 0.0697564737441253, 0.0871557427476582, 0.104528463267653, 0.121869343405147, 0.139173100960065, 0.156434465040231, 0.17364817766693, 0.190808995376545, 0.207911690817759, 0.224951054343865, 0.241921895599668, 0.258819045102521, 0.275637355816999, 0.292371704722737, 0.309016994374947, 0.325568154457157, 0.342020143325669, 0.3583679495453, 0.374606593415912, 0.390731128489274, 0.4067366430758, 0.422618261740699, 0.438371146789077, 0.453990499739547, 0.469471562785891, 0.484809620246337, 0.5, 0.515038074910054, 0.529919264233205, 0.544639035015027, 0.559192903470747, 0.573576436351046, 0.587785252292473, 0.601815023152048, 0.615661475325658, 0.629320391049837, 0.642787609686539, 0.656059028990507, 0.669130606358858, 0.681998360062498, 0.694658370458997, 0.707106781186547, 0.719339800338651, 0.73135370161917, 0.743144825477394, 0.754709580222772, 0.766044443118978, 0.777145961456971, 0.788010753606722, 0.798635510047293, 0.809016994374947, 0.819152044288992, 0.829037572555042, 0.838670567945424, 0.848048096156426, 0.857167300702112, 0.866025403784439, 0.874619707139396, 0.882947592858927, 0.891006524188368, 0.898794046299167, 0.90630778703665, 0.913545457642601, 0.92050485345244, 0.927183854566787, 0.933580426497202, 0.939692620785908, 0.945518575599317, 0.951056516295154, 0.956304755963035, 0.961261695938319, 0.965925826289068, 0.970295726275996, 0.974370064785235, 0.978147600733806, 0.981627183447664, 0.984807753012208, 0.987688340595138, 0.99026806874157, 0.992546151641322, 0.994521895368273, 0.996194698091746, 0.997564050259824, 0.998629534754574, 0.999390827019096, 0.999847695156391, 1.0};

// textura del planeta tierra en colores de 16 bits
const unsigned short textura_tierra[] = {22230, 22231, 22230, 22230, 22197, 21173, 22230, 22230, 22230, 22230, 22231, 22230, 22230, 23287, 23288, 23287, 22230, 22229, 22230, 22197, 22230, 22230, 22230, 22231, 23255, 23287, 23287, 23288, 23320, 23288, 23288, 24344, 23287, 22263, 22230, 22230, 21206, 22230, 22230, 22231, 22230, 21206, 21206, 22230, 22231, 22231, 22263, 23287, 22231, 23287, 22263, 22231, 22231, 22231, 22230, 22230, 22231, 23288, 23320, 23288, 23287, 22198, 22197, 22230, 17935, 17935, 18959, 18991, 18991, 17968, 19025, 19025, 20082, 21106, 21139, 21172, 21172, 20116, 20117, 20149, 20084, 17969, 16911, 16911, 16910, 16877, 16878, 16879, 15821, 15820, 16879, 18993, 19026, 19059, 21173, 21173, 20115, 20083, 19059, 20083, 20084, 19092, 19092, 18036, 18036, 19060, 19059, 19059, 19059, 19059, 19060, 19060, 19092, 19092, 19092, 20116, 20116, 20117, 20116, 21140, 21173, 21173, 20116, 19059, 17936, 17903, 18992, 18992, 9414, 9413, 9413, 9414, 10470, 11528, 13675, 14764, 16879, 18993, 18993, 17969, 16879, 15823, 20116, 20149, 21174, 18001, 19026, 19059, 19059, 13675, 8357, 8324, 8356, 8324, 8357, 13675, 17969, 21173, 22263, 22264, 22263, 22231, 22263, 23288, 22232, 21207, 22230, 22230, 22230, 20117, 18035, 15888, 18002, 20116, 22230, 21174, 20117, 19060, 20149, 22264, 24378, 23321, 21206, 19092, 21174, 22230, 22230, 22197, 20083, 13642, 10471, 9414, 5120, 5120, 5152, 5153, 5153, 5152, 6177, 6177, 6210, 7234, 6210, 6209, 5153, 6210, 9381, 8324, 8324, 7234, 9381, 13708, 22198, 11528, 5121, 5120, 6177, 5120, 5121, 6210, 7267, 9381, 10504, 11562, 12618, 12586, 13674, 11562, 10504, 13708, 14699, 21106, 24344, 23321, 22264, 20116, 14797, 15790, 21207, 23288, 22230, 24310, 25366, 23219, 24277, 26457, 25434, 22230, 22230, 25401, 23221, 18993, 13675, 8357, 6177, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 4096, 5120, 5120, 5152, 9414, 10471, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 4096, 4096, 5120, 4096, 5120, 4096, 5153, 9414, 6210, 4096, 4096, 5120, 6209, 8357, 8324, 11528, 10404, 8324, 9380, 8291, 12584, 12552, 9381, 6210, 4096, 4096, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5153, 5120, 5120, 5120, 5120, 5120, 4096, 4096, 5120, 5120, 5120, 5120, 5120, 4096, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 4096, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 7267, 7399, 5120, 5153, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5121, 5153, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5153, 5120, 5120, 5120, 5120, 5120, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5153, 5121, 5152, 5153, 5152, 5121, 8389, 8589, 5185, 5120, 5152, 5120, 5120, 5120, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 5120, 5120, 5120, 5153, 5120, 5152, 5153, 5120, 5153, 5153, 5152, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 5120, 5120, 5120, 5120, 5120, 5152, 5153, 5153, 5121, 5153, 5153, 5120, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5153, 5153, 5152, 5152, 5152, 5153, 5153, 7500, 6376, 5153, 5153, 5120, 5120, 5120, 6177, 6177, 6177, 6177, 6177, 6177, 5152, 5120, 5120, 5153, 5120, 5153, 5152, 5153, 5152, 5153, 5152, 5152, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 5120, 5120, 5120, 5120, 5120, 5152, 5153, 5152, 5153, 5153, 5218, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5153, 5120, 5152, 5152, 5153, 5153, 5153, 8556, 5450, 4326, 5218, 5153, 5120, 5120, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 5152, 5153, 5186, 6243, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 5153, 5186, 5153, 5153, 5253, 5384, 4228, 5153, 5153, 5153, 5153, 5185, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5153, 5153, 5153, 5152, 5153, 5153, 5153, 9580, 5450, 4392, 4326, 5185, 5120, 5152, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 6210, 9582, 7500, 5285, 5153, 5153, 5153, 5152, 5152, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 5285, 6443, 6411, 7437, 10739, 8657, 5418, 5186, 5153, 6177, 5152, 5120, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 10638, 6540, 3368, 3367, 4260, 5153, 5120, 6177, 6177, 6177, 6177, 6177, 6177, 5153, 5120, 9515, 11796, 8623, 6442, 5219, 6211, 5252, 5152, 5152, 5153, 5152, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 8526, 7568, 8593, 8593, 11799, 9715, 6475, 5186, 5153, 5153, 5152, 5120, 6177, 5153, 5153, 5153, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5152, 5153, 5121, 5152, 5152, 5153, 9582, 6541, 3368, 4425, 5483, 4359, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6177, 8524, 9648, 7565, 5451, 5252, 5218, 5385, 5153, 5153, 5121, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6243, 8525, 8625, 8592, 8625, 7567, 6276, 5153, 5153, 5185, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 6177, 5120, 5152, 5153, 5153, 5153, 6342, 4393, 1285, 2310, 3368, 4426, 4393, 4194, 5120, 5120, 5152, 5120, 5120, 5120, 5120, 5153, 5351, 4393, 3336, 3336, 3336, 5186, 5219, 5153, 5152, 5120, 5120, 5120, 5120, 5120, 5121, 5120, 5152, 5153, 5152, 5186, 6343, 6410, 6309, 6341, 5185, 5153, 5152, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 6144, 5152, 5153, 5153, 5219, 3301, 195, 228, 1252, 1285, 3368, 3369, 5351, 5153, 5120, 5152, 5152, 5120, 5152, 5120, 5152, 3269, 2279, 2311, 3336, 3368, 5185, 5152, 5153, 5120, 5120, 5120, 5153, 5153, 5120, 5153, 5120, 5185, 4194, 5185, 5153, 5153, 5218, 5250, 4292, 4162, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 6177, 6144, 5120, 5153, 5120, 5251, 2309, 228, 1219, 228, 1252, 1285, 4227, 5186, 5120, 5120, 5153, 5153, 6177, 6177, 6177, 5218, 2310, 1253, 1253, 3335, 5451, 5219, 5152, 5153, 5152, 5120, 5120, 6177, 5153, 5153, 5120, 4161, 4259, 3235, 3235, 4194, 5153, 4194, 4226, 4194, 5153, 5152, 5152, 5153, 5153, 5153, 6177, 5153, 5153, 5153, 6177, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 5153, 5120, 5152, 5153, 5153, 5218, 3334, 2310, 1253, 1253, 2244, 5186, 5120, 5120, 5120, 5153, 6145, 5153, 5186, 5218, 5185, 4260, 2309, 1285, 1285, 2343, 6574, 7600, 7335, 5153, 5120, 5153, 5120, 5153, 5153, 5153, 5153, 4227, 4194, 4194, 2211, 5185, 5185, 5153, 6177, 5153, 5153, 5153, 5152, 5152, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 5153, 5120, 5121, 5120, 5185, 5218, 3268, 3367, 3302, 3203, 5153, 6144, 6144, 5120, 5120, 6177, 5153, 4260, 3432, 4522, 6571, 6604, 4490, 2408, 3433, 3465, 3433, 9681, 10641, 5186, 5120, 5120, 5120, 5219, 5219, 5153, 5152, 5218, 4227, 5153, 5153, 5185, 5185, 5121, 6177, 5153, 5153, 5153, 5152, 5153, 5153, 5152, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 6177, 6177, 6177, 6177, 6177, 5153, 5152, 5186, 4227, 3268, 5218, 5185, 5218, 5185, 5153, 5120, 5120, 6144, 5120, 5152, 6177, 6210, 9711, 10834, 12917, 13975, 15064, 17176, 14005, 14008, 12950, 9744, 9646, 14934, 8390, 5152, 5120, 5153, 7465, 6310, 5153, 5185, 5317, 4424, 5218, 5153, 5218, 5153, 5120, 5120, 5121, 5153, 5153, 5153, 5153, 5152, 5152, 5152, 5153, 5153, 5153, 5153, 5153, 5120, 5120, 6177, 5120, 6177, 6177, 5153, 4260, 4326, 4226, 4259, 5217, 5218, 5185, 5121, 5153, 5152, 5120, 5153, 5120, 5120, 5121, 7267, 18235, 20350, 20382, 20318, 20350, 21406, 18237, 20382, 21374, 13776, 15990, 21374, 20282, 10538, 6144, 6276, 8623, 7597, 6341, 5317, 4489, 4424, 5316, 5152, 5153, 5153, 6144, 6144, 5120, 5153, 5153, 5152, 5153, 5153, 5152, 5152, 5153, 5153, 5153, 5153, 5153, 5120, 5120, 5120, 6177, 5152, 6210, 6375, 7565, 8490, 6178, 5152, 6274, 6241, 5153, 5152, 5153, 5121, 5121, 5152, 5120, 5120, 5120, 6210, 14865, 20285, 20350, 20318, 19294, 20350, 22463, 21374, 20250, 14866, 19195, 21340, 14897, 11596, 10538, 15063, 9744, 8686, 6638, 4456, 4424, 3399, 2375, 2342, 4227, 5153, 5120, 5120, 5120, 5153, 5153, 5153, 5153, 5153, 5153, 5153, 5152, 5152, 5152, 5152, 5152, 5120, 5120, 5152, 5152, 6210, 9514, 9679, 10737, 6540, 3301, 3235, 3236, 5152, 5153, 5153, 5152, 5153, 5121, 5153, 5120, 5120, 5153, 5153, 7268, 12720, 17114, 19262, 19261, 15991, 18069, 18101, 14930, 17081, 20286, 17112, 13910, 17048, 17080, 13941, 8686, 9679, 9713, 7597, 5482, 2343, 2342, 2375, 3300, 5185, 5185, 5153, 5120, 5152, 5152, 5153, 5153, 5153, 5153, 5152, 5153, 5152, 5152, 5152, 5153, 5120, 5120, 5120, 5153, 6376, 11762, 9681, 8622, 6540, 2343, 1318, 1285, 4226, 5153, 5153, 5152, 5153, 5152, 5152, 5120, 5120, 5120, 5153, 6177, 7433, 9648, 9515, 9546, 7334, 6276, 6309, 7466, 10737, 11827, 10704, 11694, 17080, 14999, 10737, 10737, 16056, 16055, 13942, 9712, 9712, 7597, 3432, 4325, 4227, 5186, 4162, 5153, 5152, 5152, 5153, 5153, 5153, 5153, 5152, 5153, 5152, 5152, 5152, 5153, 5120, 5120, 5120, 5186, 6442, 8655, 7565, 7597, 4457, 2375, 3334, 3301, 1252, 3202, 5153, 5153, 5153, 5152, 5152, 5120, 5120, 5120, 5120, 5153, 4260, 5417, 4326, 4227, 4260, 3301, 3334, 5219, 5252, 4359, 5383, 14865, 18169, 16056, 10770, 9680, 9712, 12884, 15990, 16023, 16056, 17081, 10802, 6539, 3334, 3235, 4128, 3170, 5153, 5153, 5153, 5152, 5153, 5152, 5153, 5153, 5153, 5153, 5152, 5152, 5120, 5120, 5153, 4162, 4360, 2311, 7598, 6572, 3400, 1253, 2211, 1219, 1252, 228, 2243, 4194, 5185, 5153, 5120, 5120, 5120, 5120, 5153, 5120, 5152, 4260, 2309, 1252, 1252, 2343, 1285, 3399, 3334, 4457, 7563, 9709, 11826, 12884, 10771, 10736, 7597, 9712, 9713, 9680, 9679, 8655, 8654, 5482, 3399, 1318, 2211, 4161, 5152, 5153, 5152, 5153, 5153, 5152, 5153, 5153, 5153, 5153, 5153, 5120, 5120, 5152, 5219, 3269, 2277, 2343, 5483, 3368, 1285, 1220, 2212, 2212, 2212, 1221, 1221, 2179, 5185, 6177, 6177, 6177, 5120, 5153, 5153, 5152, 4194, 3301, 4227, 3301, 2277, 2277, 1285, 1285, 2342, 2342, 3400, 3400, 4425, 4458, 3400, 4426, 3367, 2309, 2310, 1253, 2309, 2309, 2343, 1318, 1286, 1285, 2276, 4194, 5120, 4194, 4227, 5153, 5153, 5153, 5152, 5153, 4227, 3269, 4293, 5284, 8423, 7431, 3302, 2277, 1253, 1253, 1221, 2245, 2246, 4227, 4162, 5186, 4294, 4261, 4196, 4129, 5153, 9414, 10470, 6177, 6177, 6177, 5153, 5152, 4128, 4161, 5153, 3268, 1187, 3170, 2244, 1220, 1252, 1252, 1252, 1285, 1284, 1285, 1253, 1253, 1253, 228, 1252, 1253, 1285, 1285, 1286, 1286, 1285, 1285, 2277, 4261, 4260, 4260, 4260, 4228, 5218, 5153, 5318, 5285, 4260, 3335, 2310, 3334, 2310, 2311, 2311, 2279, 3269, 3303, 4360, 3336, 4361, 4328, 5318, 5251, 6340, 4294, 8455, 5120, 7333, 25368, 27449, 11527, 5120, 4096, 5284, 5219, 5120, 5152, 5153, 4194, 3301, 2212, 2212, 1187, 2211, 2244, 1253, 229, 1253, 1253, 1254, 2278, 1253, 1253, 1286, 2310, 2311, 2311, 2343, 1286, 2311, 2343, 3336, 3336, 3335, 3335, 3336, 4392, 4393, 5417, 5186, 5120, 5186, 4294, 4327, 5319, 5285, 4228, 4227, 4294, 5351, 6441, 5384, 5351, 6375, 7432, 9513, 8522, 9545, 11659, 5120, 5153, 10536, 29596, 30653, 31709, 27481, 14764, 5153, 5120, 5120, 4096, 6177, 5152, 5153, 4260, 3236, 3236, 4194, 5153, 5185, 5252, 5285, 5284, 4327, 4294, 4359, 3336, 4361, 4393, 4393, 4393, 4360, 3335, 4327, 4326, 4359, 4360, 3303, 3270, 4261, 5253, 5285, 6310, 5153, 5120, 5120, 5152, 5152, 5120, 5120, 5120, 5120, 5153, 6276, 8390, 7334, 9414, 10504, 16846, 15822, 15855, 11528, 8357, 12585, 17903, 29595, 31710, 31710, 32766, 31710, 27514, 13707, 6178, 5120, 5120, 5120, 6177, 7267, 8323, 7267, 5153, 5153, 5152, 6177, 7267, 11495, 8291, 6177, 6177, 5186, 5252, 8489, 9547, 8490, 6376, 5218, 5153, 5153, 5152, 6210, 7300, 5153, 5152, 5120, 6144, 5152, 5120, 5120, 5120, 5120, 5120, 5120, 5152, 6144, 5120, 6144, 5120, 6177, 6210, 6210, 7234, 7267, 9414, 11561, 14765, 17902, 15789, 17902, 16846, 17903, 20017, 24278, 26392, 24278, 20017, 10471, 7267, 5120, 5120, 6177, 6177, 7267, 8323, 7234, 5152, 5120, 6177, 6177, 6177, 6209, 7234, 6177, 5120, 5120, 5120, 7234, 8323, 7267, 6177, 6144, 6144, 5120, 6144, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5120, 5152, 5152, 5152, 5153, 5153, 5153, 5120, 5120, 5120, 5120, 6176, 6176, 5153, 5153, 6144, 6177, 6177, 6210, 7234, 6209, 5153, 6177, 6178, 7234, 7267, 7267, 7267, 7234, 6177, 6177, 5120, 5120, 6144, 6144, 5120, 5120, 5120, 5121, 5120, 6144, 5120, 5120, 6144, 6177, 5120, 5120, 6144, 6144, 5120, 5120, 6177, 6144, 6144, 6176, 6177, 6145, 6144, 5152, 5153, 5152, 5153, 5153, 5153, 5153};

// valores de un semicirculo
const float semicirculo[] = {1.0, 0.9999382696996233, 0.999753055929066, 0.9994442900376633, 0.9990118574661788, 0.9984555975339683, 0.9977753031397177, 0.9969707203744504, 0.9960415480451098, 0.99498743710662, 0.9938079899999065, 0.9925027598929193, 0.9910712498212337, 0.9895129117243169, 0.9878271453730164, 0.9860132971832694, 0.9840706589104234, 0.9819984662179065, 0.9797958971132712, 0.9774620702438699, 0.9749960430435691, 0.9723968097209881, 0.9696632990787302, 0.9667943721519542, 0.9637888196533974, 0.9606453592105879, 0.9573626323794674, 0.9539392014169457, 0.9503735457930265, 0.9466640584210286, 0.9428090415820634, 0.9388067025172744, 0.9346551486583596, 0.9303523824635243, 0.9258962958222071, 0.9212846639876111, 0.916515138991168, 0.9115852424874964, 0.9064923579720506, 0.901233722306385, 0.8958064164776166, 0.8902073555090798, 0.8844332774281066, 0.8784807311840872, 0.8723460633951343, 0.8660254037844386, 0.8595146491472764, 0.8528094456660784, 0.8459051693633013, 0.838796904449212, 0.8314794192830981, 0.8239471396205517, 0.8161941187647537, 0.808214004174148, 0.8, 0.7915448249319448, 0.7828406646137128, 0.7738791177495933, 0.7646511348482334, 0.7551469483353865, 0.7453559924999299, 0.73526681140292, 0.7248669524577819, 0.714142842854285, 0.7030796453136167, 0.6916610887771518, 0.6798692684790381, 0.6676844083366051, 0.6550845765770522, 0.6420453428086074, 0.6285393610547089, 0.6145358581788816, 0.5999999999999999, 0.5848920972556381, 0.56916659888292, 0.5527707983925666, 0.5356431463641755, 0.5177110114320775, 0.4988876515698588, 0.47906802527355774, 0.45812284729085123, 0.4358898943540673, 0.4121608220220313, 0.3866602809178958, 0.3590109871423002, 0.3286710990610898, 0.2948110924760355, 0.25603819159562036, 0.20964402515681355, 0.14865653511399576, 0.0};

// arreglo de puntos 3D
// 32 * 64 * 3 = 6144
float puntos[6144];

// arreglo con el orden de los puntos
unsigned short orden[NUMERO_PUNTOS];

// punto sobre el que se esta haciendo la operacion
unsigned short color;
float x;
float y;
float z;

// posicion de la camara
float cz = -150.0;

// posicion del punto de observacion
float ez = 140.0;

void colorear_punto() {
    // voltear eje Y
    y *= -1;

    // centrar los puntos en la pantalla
    x += MITAD_ANCHO_PANTALLA;
    y += MITAD_ALTO_PANTALLA;

    // redondear
    x = (int) (x + 0.5);
    y = (int) (y + 0.5);

    // revisar si el punto no se puede colorear
    if (x < 0) return;
    if (y < 0) return;
    if (x >= ANCHO_PANTALLA) return;
    if (y >= ALTO_PANTALLA) return;

    // colorear
    for (int i = -3; i <= 3; i++)
        for (int j = -3; j <= 3; j++)
            MEMORIA_VIDEO[(int) (x + i) + (int) (y + j) * ANCHO_PANTALLA] = color;
}

float seno(int angulo) {
    // corregir el angulo si es negativo
    if (angulo < 0)
        return seno(angulo * -1) * -1;

    // corregir el angulo si es mayor a 360
    if (angulo >= 360)
        return seno(angulo % 360);

    // los angulos de 0 a 90 son conocidos
    if (angulo <= 90)
        return valores_seno[angulo];

    // los angulos de 91 a 179 son un reflejo de los de 0 a 90
    if (angulo < 180)
        return valores_seno[180 - angulo];

    // los angulos de 180 a 269 son iguales a los de 0 a 90 con signo negativo
    if (angulo < 270)
        return valores_seno[angulo - 180] * -1;

    // los angulos de 270 a 360 son un reflejo negativo de los de 0 a 90
    return valores_seno[360 - angulo] * -1;
}

float coseno(int angulo) {
    // usar funcion seno desplazada
    return seno(90 - angulo);
}

void inicializar() {
    // encender pantalla
    CONTROL_PANTALLA = ENCENDIDO;

    // generar el orden original
    for (int i = 0; i < NUMERO_PUNTOS; i++) {
        orden[i] = i;
    }
}

void traslacion() {
    // mover el punto segun la camara
    z -= cz;
}

void proyectar() {
    // proyectar el punto 3D a 2D
    x = (x * ez) / z;
    y = (y * ez) / z;
}

void ordenamiento_rapido_recursivo(int limite_izq, int limite_der) {
    int temporal;
    int izq = limite_izq;
    int der = limite_der;
    float pivote = puntos[orden[((izq + der) / 2)] * 3 + 2];

    do {
        while (puntos[orden[izq] * 3 + 2] > pivote && izq < limite_der) izq++;
        while (pivote > puntos[orden[der] * 3 + 2] && der > limite_izq) der--;
        if (izq <= der) {
            temporal = orden[izq];
            orden[izq] = orden[der];
            orden[der] = temporal;
            izq++;
            der--;
        }
    } while (izq <= der);
    if (limite_izq < der) {
        ordenamiento_rapido_recursivo(limite_izq, der);
    }
    if (limite_der > izq) {
        ordenamiento_rapido_recursivo(izq, limite_der);
    }
}

void ordenamiento_rapido() {
    ordenamiento_rapido_recursivo(0, NUMERO_PUNTOS - 1);
}

int main() {
    // todo lo necesario para iniciar
    inicializar();

    // desfase en el angulo de rotacion
    int desfase = 0;

    while (VERDADERO) {
        // generar modelo
        for (int i = 0; i < 32; i++) {
            for (int j = 0; j < 64; j++) {
                puntos[i * 64 * 3 + j * 3 + 0] = seno(((j + desfase) * 180) / 32) * -50.0;
                puntos[i * 64 * 3 + j * 3 + 1] = ((i * 100.0) / 32.0) - 50.0;
                puntos[i * 64 * 3 + j * 3 + 2] = coseno(((j + desfase) * 180) / 32) * 50.0;

                if (i < 16) {
                    puntos[i * 64 * 3 + j * 3 + 0] *= semicirculo[((16 - i) * 90) / 16];
                    puntos[i * 64 * 3 + j * 3 + 2] *= semicirculo[((16 - i) * 90) / 16];
                } else {
                    puntos[i * 64 * 3 + j * 3 + 0] *= semicirculo[((i - 16) * 90) / 16];
                    puntos[i * 64 * 3 + j * 3 + 2] *= semicirculo[((i - 16) * 90) / 16];
                }
            }
        }

        // ordenar puntos
        ordenamiento_rapido();

        // procesar puntos
        for (int i = NUMERO_PUNTOS / 2; i < NUMERO_PUNTOS; i++) {
            // punto
            color = textura_tierra[orden[i]];
            x = puntos[orden[i] * 3 + 0];
            y = puntos[orden[i] * 3 + 1];
            z = puntos[orden[i] * 3 + 2];

            // tuberia
            traslacion();
            proyectar();

            // colorear
            colorear_punto();
        }

        // cambiar el desfase para animacion+
        desfase += 10;
    }

    // fin del programa
    return 0;
}